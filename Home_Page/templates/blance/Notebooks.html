{% extends "base.html" %}
{% load static %}
{% load url_utils %}
{% block body_class %}body-home{% endblock %}

{% block notebooks %}
<object type="image/svg+xml" data="{% static 'icons/icons_for_notebooks.svg' %}" style="display:none;"></object>
<link rel="stylesheet" href="{% static 'Home_page/css/style.css' %}">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Приклад сторінки</title>
    <style>
        ul {
            list-style-type: none;
            padding-left: 0;
        }

        body.body-home {
            background: #f6f7fb;
            color: #111;
            padding-top: 40px;
        }

        li {
            list-style-type: none;
        }

        .goods-tile_inner {
            width: 252.8px;
            height: 430.72px;
            overflow: hidden;
            box-sizing: border-box;
        }

        .goods-tile_inner img {
            width: 100%;
            height: auto;
            display: block;
        }

        @media (max-width: 600px) {
            .goods-tile_inner {
                width: 150px;
                height: 200px;
            }
        }

        .locations {
            background: #fff;
            color: #000;
        }

        input {
            background-color: #fff;
            box-sizing: border-box;
            padding-left: 12px;
            padding-right: 12px
        }

        input,input[_size_small] {
            height: 32px;
        }

        @media (min-width: 768px)
            input, textarea {
            font-size: 14px;
        }

        input,textarea {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            background-color: #fff;
            border: 1px solid #d2d2d2;
            border-radius: 8px;
            font-size: 16px;
            outline: none;
            transition: border .2s ease-in-out
        }

        .bread {
            display: flex;
            flex-direction: row;
            flex-wrap: wrap;
            align-items: center;
            margin-top: 8px;
            margin-bottom: 8px;
        }

        section1 ul1 div2 {
            margin: 0;
            padding: 0;
            border: 0;
            font-size: 100%;
            font: inherit;
            vertical-align: baseline;
        }

        .mode-small .buy-button {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            width: 32px;
            height: 32px;
            margin: 0 0 0 auto;
            padding: 0;
            border: none;
            background-color: #fff;
            cursor: pointer;
        }

        .goods-tile__price {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 6px;
            font-weight: 700;
            font-size: 18px;
            color: #111;
            margin-top: 6px;
        }

        .price-currency {
            font-size: 16px;
            color: #555;
        }

        .buy-button {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border: 1px solid #e0e0e0;
            border-radius: 10px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            background: #fff;
            cursor: pointer;
            transition: all 0.2s ease-in-out;
            color: white;
        }

        .buy-button:hover {
            background: #f5f5f5;
            box-shadow: 0 0 4px rgba(0,0,0,0.15);
        }

        .buy-button svg {
            width: 22px;
            height: 22px;
            vertical-align: middle;
        }

        .add-to-cart {
            cursor: pointer;
            transition: fill 0.3s ease;
            fill: #0098db;
        }

        .add-to-cart.in-cart {
            fill: #00b44b;
            transform: scale(1.1);
        }

        .buy-button svg {
            transition: transform 0.3s ease, fill 0.3s ease, stroke 0.3s ease;
            cursor: pointer;
        }

        .in-cart-btn svg {
            fill: #667eea;
            transform: scale(1.1);
        }

        .buy-button.added svg {
            animation: pulse 0.4s ease;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                fill: #00b44b;
            }
            50% {
                transform: scale(1.3);
                fill: #00ff6e;
            }
            100% {
                transform: scale(1);
                fill: #00b44b;
            }
        }

        .sidebar1 {
            position: sticky;
            top: 90px;
        }

        .catalog-header {
            position: sticky;
            top: 0;
            z-index: 10;
            border-radius: 14px 14px 0 0;
            box-shadow: -4px -4px 14px rgba(0, 0, 0, 0.06);
            background: white;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #e5e7eb;
        }


        .catalog-grid__cell:hover {
            transform: translateY(-6px);
            box-shadow: 0 16px 40px rgba(0,0,0,0.15);
        }

        .goods-tile__picture img {
            width: 100%;
            height: 200px;
            object-fit: contain;
        }

        .goods-tile__picture {
            font-weight: 600;
            color: #111827;
            text-decoration: none;
        }

        .goods-tile__price {
            margin-top: auto;
            font-size: 1.2rem;
            font-weight: 700;
        }

    </style>
</head>
<div1 class="central-wrapper">
    <main style="order: 2;">
        <div class="layout">
            <ul class="bread">
                <li class="breadcrumbs__item breadcrumbs__item--home">
                    <a class="breadcrumbs__link" title="Інтернет-магазин SmartHub" href="{% url 'home' %}">
                        <i class="bi bi-house-door-fill breadcrumbs__icon-home"></i>
                        <span class="breadcrumbs__item--home--title">На головну</span>
                    </a>
                    <span class="breadcrumbs__separator">/</span>
                </li>
                <li class="breadcrumbs__item breadcrumbs__item--last">
                    <a class="breadcrumbs__link" href="{% url 'notebooks' %}">
                        <span style="font-weight: 700;">Ноутбуки та комп'ютери</span>
                    </a>
                    <span class="breadcrumbs__separator">/</span>
                </li>
                <li class="breadcrumbs__item breadcrumbs__item--text">
                    <svg aria-hidden="true" class="breadcrumbs__icon-chevron breadcrumbs__icon-chevron--text">
                        <use href="{% static 'icons/icons_for_notebooks.svg' %}#icon-chevron-down"></use>
                    </svg>
                    <span class="breadcrumbs__separator-last">/</span>
                    <a class="breadcrumbs__link" href="{% url 'notebooks' %}">
                        <span style="font-weight: 700;">Ноутбуки</span>
                    </a>
                </li>
            </ul>
            <div>
                <h1 class="catalog-heading">Ноутбуки</h1>
            </div>
        </div>
        <ul>
            <div2 class="catalog">
                <div class="layout animation">
                    <div1 class="catalog-header">
                        <div1 class="catalog-selection">
                            <p class="catalog-selection__label"> Найдено {{ notebooks_count }} товарів </p>
                            <ul class="catalog-selection__list"></ul>
                        </div1>
                        <div class="catalog-settings__sorting" style="margin-right: 0px;">
                            <select class="select-css" id="sort-select" onchange="redirectToPage()">
                                <option value="" {% if not request.GET.sort %}selected{% endif %}>Сортування</option>
                                <option value="price_asc" {% if request.GET.sort == 'price_asc' %} selected="selected"{% endif %}>Від дешевих до дорогих</option>
                                <option value="price_desc" {% if request.GET.sort == 'price_desc' %} selected="selected"{% endif %}>Від дорогих до дешевих</option>
                            </select>
                        </div>
                    </div1>
                </div>
                <div2 class="layout layout_with_sidebar">
                    <section class="content_type_catalog" style="display: block; margin: 0; padding: 0; border: 0; font-size: 100%; font: inherit; vertical-align: baseline;">
                        <ul class="catalog-grid catalog-grid__cell1" style="margin: 0; padding: 0; border: 0; font-size: 100%; font: inherit; vertical-align: baseline;">
                            {% for i in items %}
                            <li class="catalog-grid__cell">
                                <div2 class="goods-tile" data-title="small">
                                    <div2 class="goods-tile__inner" style="margin: 0; padding: 0; border: 0; font-size: 100%; font: inherit; vertical-align: baseline;">
                                        <div2 class="goods-tile__content">
                                            <a class="image-with-text goods-tile__picture" href="{% url 'product_detail' id=i.id %}" title="{{ i.name }}" style="margin: 0; padding: 0; border: 0; font-size: 100%; vertical-align: baseline;">
                                                <img  loading="lazy" src="{{ i.images }}" style="margin: 0; padding: 0; border: 0; font-size: 100%; font: inherit; vertical-align: baseline; width: 200px; height: 150px; object-fit: cover; display: block; margin: 0 auto;">{{ i.name }}
                                            </a>
                                        </div2>
                                    </div2>
                                </div2>
                                <div class="goods-tile__price price--red">
                                    <span class="price-value">{{ i.price }}</span>
                                    <button type="button" class="buy-button buy-btn" data-product-id="{{ i.id }}">
                                        <svg class="icon-comparison add-to-cart" width="24" height="24">
                                            <use href="{% static 'icons/icons_for_notebooks.svg' %}#icon-comparison"></use>
                                        </svg>
                                    </button>
                                    <button data-product-id="{{ i.id }}"
                                            class="buy-button in-cart-btn" onclick="openBasketModal()" style="display:none;">
                                        <svg width="24" height="24">
                                            <use href="{% static 'icons/icons_for_notebooks.svg' %}#icon-comparison-1"></use>
                                        </svg>
                                    </button>
                                </div>
                            </li>
                            {% endfor %}
                        </ul>
                    </section>
                    <aside class="sidebar1"  style="margin: 0; border: 0; font-size: 100%; font: inherit;  vertical-align: baseline;">
                        <div2 class="catalog--sticky" style="--topPosition: 145px; margin: 0; padding: 0; border: 0; font-size: 100%; font: inherit; vertical-align: baseline; height: 100%;">
                            <div class="sidebar-block" data-filter-name="producer" style="border-radius: 0px 0px 14px 14px;">
                                <button type="button" class="sidebar-block__toggle">
                                    <span class="sidebar-block__toggle-title">
                                        Продавець
                                        <span class="sidebar-block__toggle-quantity"> 2 </span>
                                    </span>
                                    <svg width="16" height="16" class="sidebar-block__toggle-icon">
                                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{% static 'icons/icons_for_notebooks.svg' %}#icon-angle-left"></use>
                                    </svg>
                                </button>
                                <div class="sidebar-block__inner" style="overflow-x: hidden;">
                                    <div class="scrollbar__layout">
                                        <div class="scrollbar__layouter">
                                            <div class="scrollbar__inner" style="width: 251px;">
                                                <div style="width: 233px;">
                                                    <div1>
                                                        <ul class="checkbox-filter">
                                                            <li>
                                                                <a class="checkbox-filter__link" data-id="SmartHub +" href="{% url 'home' %}">
                                                                    SmartHub +&nbsp
                                                                </a>
                                                            </li>
                                                            <li>
                                                                <a class="checkbox-filter__link" data-id="Інші продавці" href="{% url 'home' %}">
                                                                    Інші продавці&nbsp;
                                                                </a>
                                                            </li>
                                                        </ul>
                                                        <ul class="checkbox-filter"></ul>
                                                    </div1>
                                                </div>
                                            </div>
                                            <div class="scrollbar__holder" style="right: -8px;">
                                                <div class="scrollbar__path">
                                                    <div class="scrollbar__slider" style="height: 71px; transform: translateY(0px);"></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="sidebar-block" data-filter-name="producer">
                                <button type="button" class="sidebar-block__toggle">
                                    <span class="sidebar-block__toggle-title">
                                        Бренд
                                        <span class="sidebar-block__toggle-quantity"> {{ NotebooksBrand_count }} </span>
                                    </span>
                                    <svg width="16" height="16" class="sidebar-block__toggle-icon">
                                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{% static 'icons/icons_for_notebooks.svg' %}#icon-angle-left"></use>
                                    </svg>
                                </button>
                                <div class="sidebar-block__inner" style="overflow-x: hidden;">
                                    <div>
                                        <div class="sidebar-search">
                                            <form method="get">
                                                <input type="search" name="search" value="{{ request.GET.search }}" class="sidebar-search__input" placeholder="Пошук">
                                                <button type="submit" class="sidebar-search__button" style="display: none;"></button>
                                            </form>
                                        </div>
                                    </div>
                                    <div class="sidebar-block">
                                        <div class="scrollbar__layout">
                                            <div class="scrollbar__inner" style="width: 251px;">
                                                <div style="width: 233px;">
                                                    <div>
                                                        <ul class="checkbox-filter">
                                                            {% for brand in brands_count %}
                                                                    <li class="checkbox-filter__item" type="checkbox">
                                                                        <a class="checkbox-filter__link" href="?{% url_replace request 'producer' brand.noteb_id__name %}">
                                                                           {{ brand.noteb_id__name }} ({{ brand.count }})
                                                                        </a>
                                                                    </li>
                                                            {% endfor %}
                                                        </ul>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="scrollbar__holder" style="right: 0px;">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="sidebar-block" data-filter-name="price">
                                        <button type="button" class="sidebar-block__toggle">
                                            <span class="sidebar-block__toggle-title">
                                                Цiна
                                            </span>
                                            <svg width="16" height="16" class="sidebar-block__toggle-icon">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{% static 'icons/icons_for_notebooks.svg' %}#icon-angle-left"></use>
                                            </svg>
                                        </button>
                                        <div class="sidebar-block__inner" style="overflow-x: hidden; margin-bottom: 20px;">
                                            <div class="scrollbar__layout">
                                                <div class="scrollbar__inner" style="width: 251px;">
                                                    <div style="width: 233px;">
                                                        <form method="get" class="slider-filter__form">
                                                            <div class="slider-filter__inner">
                                                                <input type="text" name="min" value="{{ request.GET.min }}" class="slider-filter__input" maxlength="20" placeholder="Мін">
                                                                <span aria-hidden="true" class="slider-filter__divider"> — </span>
                                                                <input type="text" name="max" value="{{ request.GET.max }}" class="slider-filter__input" maxlength="20" placeholder="Макс">
                                                                <button type="submit" class="button button_color_gray button_size_small slider-filter__button"> Ok </button>
                                                                {% for key, value in request.GET.items %}
                                                                    {% if key != 'min' and key != 'max' %}
                                                                        <input type="hidden" name="{{ key }}" value="{{ value }}">
                                                                    {% endif %}
                                                                {% endfor %}
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                                <div class="scrollbar__holder" style="right: -8px;">
                                                    <div class="scrollbar__path">
                                                        <div class="scrollbar__slider" style="height: 20px; transform: translateY(0px);"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="sidebar-block sidebar-block_state_collapsed" data-filter-name="processor">
                                        <button type="button" class="sidebar-block__toggle">
                                            <span class="sidebar-block__toggle-title">
                                                Процесор
                                                <span class="sidebar-block__toggle-quantity"> 11 </span>
                                            </span>
                                            <svg width="16" height="16" class="sidebar-block__toggle-icon">
                                                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="{% static 'icons/icons_for_notebooks.svg' %}#icon-angle-left"></use>
                                            </svg>
                                        </button>
                                        <div class="sidebar-block__inner" style="overflow-x: hidden;">
                                            <div class="scrollbar__layout">
                                                <div class="scrollbar__inner" style="width: 251px;">
                                                    <div style="width: 233px;">
                                                        <ul class="checkbox-filter">
                                                            {% for processor in processor_count %}
                                                                <li>
                                                                    <a class="checkbox-filter__link" href="?{% url_replace request 'processor' processor.processor_id__processor %}">
                                                                        {{ processor.processor_id__processor }} ({{ processor.count }})
                                                                    </a>
                                                                </li>
                                                            {% endfor %}
                                                        </ul>
                                                    </div>
                                                </div>
                                                <div class="scrollbar__holder" style="right: -8px;">
                                                    <div class="scrollbar__path">
                                                        <div class="scrollbar__slider" style="height: 643px; transform: translateY(0px);"></div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div2>
                    </aside>
                </div2>
            </div2>
        </ul>
    </main>
    <hr>
<script>
    function redirectToPage() {
        const selectElement = document.getElementById('sort-select');
        const selectedValue = selectElement.value;

        const currentUrl = new URL(window.location.href);
        if (selectedValue) {
            currentUrl.searchParams.set('sort', selectedValue);
        } else {
            currentUrl.searchParams.delete('sort');
        }

        window.location.href = currentUrl.toString();
    }
</script>
<script>
document.addEventListener("DOMContentLoaded", function () {
    const buyBtns = document.querySelectorAll(".buy-btn");
    const inCartBtns = document.querySelectorAll(".in-cart-btn");

    updateButtons();

    buyBtns.forEach((buyBtn, index) => {
        const inCartBtn = inCartBtns[index];
        const productId = buyBtn.dataset.productId;

        buyBtn.addEventListener("click", function () {
            let cart = JSON.parse(localStorage.getItem("cart")) || [];

            if (!cart.includes(productId)) {
                cart.push(productId);
                localStorage.setItem("cart", JSON.stringify(cart));
            }

            toggleButtons(inCartBtn, buyBtn);
        });
    });

    window.addEventListener("cartUpdated", updateButtons);
    window.addEventListener("storage", updateButtons);

    function updateButtons() {
        const cart = JSON.parse(localStorage.getItem("cart")) || [];

        buyBtns.forEach((buyBtn, index) => {
            const inCartBtn = inCartBtns[index];
            const productId = buyBtn.dataset.productId;

            if (cart.includes(productId)) {
                toggleButtons(inCartBtn, buyBtn);
            } else {
                toggleButtons(buyBtn, inCartBtn);
            }
        });
    }
});

function toggleButtons(showBtn, hideBtn) {
    hideBtn.style.display = "none";
    showBtn.style.display = "inline-block";
}
</script>
    <script>
document.querySelectorAll('.checkbox-filter__link').forEach(link => {
    link.addEventListener('click', function () {
        this.classList.toggle('active');
    });
});
</script>

{% endblock %}
</div1>